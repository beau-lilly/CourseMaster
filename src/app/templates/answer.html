{% extends "layout.html" %}

{% block content %}

    {% if exam_id and course_id %}
        <a href="{{ url_for('view_exam', course_id=course_id, exam_id=exam_id) }}">&larr; Back to exam</a>
    {% else %}
        <a href="{{ url_for('index') }}">&larr; Back home</a>
    {% endif %}

    <h2>Result</h2>

    <article>
        <header><strong>Your Question:</strong></header>
        <p>{{ question }}</p>
    </article>

    <article>
        <header><strong>Explanation:</strong></header>
        <p>{{ explanation }}</p>
    </article>

    <hr>
    
    <h3>Relevant Chunks</h3>
    <p>These are the parts of your documents used to generate the answer.</p>

    {% for chunk in chunks %}
        <details>
            <summary>
                Result {{ chunk.rank }} (chunk #{{ chunk.chunk_index }} from: {{ chunk.source }})
                {% if chunk.similarity is not none %}- similarity: {{ "%.3f"|format(chunk.similarity) }}{% endif %}
            </summary>
            <p>{{ chunk.text }}</p>
        </details>
    {% else %}
        <p>No relevant chunks were found.</p>
    {% endfor %}

    <br>
    {% if exam_id and course_id %}
        <a href="{{ url_for('view_exam', course_id=course_id, exam_id=exam_id) }}" role="button">Ask another question</a>
    {% else %}
        <a href="{{ url_for('index') }}" role="button">Back home</a>
    {% endif %}

{% endblock %}
